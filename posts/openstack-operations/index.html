<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>OpenStack 不完全使用手册 | XhstormR</title><meta name=keywords content="OpenStack"><meta name=description content="OpenStack 不完全使用手册 - XhstormR"><meta name=author content><link rel=canonical href=https://xhstormr.github.io/blog/posts/openstack-operations/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.a090830a421002426baafbd314e38f149d77b4c48a12ee9312700d770b27fb26.css integrity="sha256-oJCDCkIQAkJrqvvTFOOPFJ13tMSKEu6TEnANdwsn+yY=" rel="preload stylesheet" as=style><link rel=icon href=https://xhstormr.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://xhstormr.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://xhstormr.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://xhstormr.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://xhstormr.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://xhstormr.github.io/blog/posts/openstack-operations/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://xhstormr.github.io/blog/posts/openstack-operations/"><meta property="og:site_name" content="XhstormR"><meta property="og:title" content="OpenStack 不完全使用手册"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-05-07T08:15:41+08:00"><meta property="article:modified_time" content="2016-05-07T08:15:41+08:00"><meta property="article:tag" content="OpenStack"><meta name=twitter:card content="summary"><meta name=twitter:title content="OpenStack 不完全使用手册"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://xhstormr.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"OpenStack 不完全使用手册","item":"https://xhstormr.github.io/blog/posts/openstack-operations/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"OpenStack 不完全使用手册","name":"OpenStack 不完全使用手册","description":"","keywords":["OpenStack"],"articleBody":"Updated on 2016-10-06\ncurl - 命令行浏览器 OpenStack 服务提供 RESTful API，而 curl 能通过命令行直接发送和接收 HTTP 的请求和响应\n-X [HEAD,POST,GET,PUT,DELETE] # 指定 HTTP 的请求类型 Request -H \"name:123\" #添加 HTTP 请求头 Header -D [123,-] #将 HTTP 响应头输出到[文件,终端] Dump -i #同时显示 HTTP 响应头 Include -I #只显示文档信息 Head -u admin:pass #登录验证 User -k #忽略主机密钥（SSL 证书） Insecure -s #不显示进度条 Silent -v #显示详细信息 Verbose -d @123.json #指定 POST 数据包 Data -F file=@123.png #指定表单数据 Form ------------------------------------------------------- -A \"Mozilla/5.0 (Linux; Android 5.1.1; Nexus 6 Build/LYZ28E) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.20 Mobile Safari/537.36\" #指定 User-Agent -e \"www.qq.com\" #指定 Referrer URL -x 10.34.3.71:808 #指定代理服务器 -o \"123.7z\" #保存至本地 -O #使用服务器上的文件名 -R #使用服务器上的文件修改时间 -b \"NAME1=VALUE1; NAME2=VALUE2\" #设置 Cookie -b 123.txt #读取 Cookie -c 123.txt #保存 Cookie -C - #断点续传 Continue -L #自动重定向 Location --limit-rate 200K #限速 https://curl.haxx.se/windows/ https://curl.haxx.se/docs/manpage.html curl -s -H \"X-Auth-Token:123\" http://0.0.0.0:35357/v2.0/tenants | python -mjson.tool #格式化输出 JSON [root@controller ~]$ a=`keystone token-get | awk 'NR==5{print $4}'` [root@controller ~]$ echo $a [root@controller ~]$ curl -H \"X-Auth-Token:$a\" http://0.0.0.0:35357/v2.0/tenants ------------------------------------------------------- [root@controller ~]$ keystone --debug tenant-list v2.0 [root@controller ~]$ glance --debug image-list v1 [root@controller ~]$ nova --debug list v2 ------------------------------------------------------- keystone catalog nova endpoints ------------------------------------------------------- openstack-status openstack-service restart KEYSTONE keystone token-get | awk 'NR==5{print $4}' 获取 Token 第5行第4列 nova endpoints | grep -A 7 keystone 获取 Endpoint 35357 curl -H \"X-Auth-Token:$a\" http://0.0.0.0:35357/v2.0/users 返回用户 curl -H \"X-Auth-Token:$a\" http://0.0.0.0:35357/v2.0/users/123 返回某个用户 curl -H \"X-Auth-Token:$a\" http://0.0.0.0:35357/v2.0/tenants 返回租户 curl -H \"X-Auth-Token:$a\" http://0.0.0.0:35357/v2.0/tenants/123 返回某个租户 curl -H \"X-Auth-Token:$a\" http://0.0.0.0:35357/v2.0/tenants/123/users/123/roles 返回某个租户上用户被授予的角色 curl -H \"X-Auth-Token:$a\" http://0.0.0.0:35357/v2.0/endpoints 返回服务端点 curl -H \"X-Auth-Token:$a\" http://0.0.0.0:35357/v2.0/tokens/$a 检验 Token 有效性，并返回 Token 信息 curl -I -H \"X-Auth-Token:$a\" http://0.0.0.0:35357/v2.0/tokens/$a 使用 Header 校验 Token 有效性 ------------------------------------------------------- keystone user-role-list --user 123 --tenant admin 查看用户在某个租户中的角色 keystone --os-token 123 --os-endpoint http://0.0.0.0:35357/v2.0 user-role-add --user admin --role admin --tenant admin 使用 Token 鉴权 keystone.conf - admin_token = 123 Token 验证 export OS_SERVICE_TOKEN=cacb79002f export OS_SERVICE_ENDPOINT=http://0.0.0.0:35357/v2.0 ----------- Password 验证 export OS_USERNAME=admin export OS_PASSWORD=000000 export OS_TENANT_NAME=admin export OS_AUTH_URL=http://0.0.0.0:35357/v2.0 GLANCE keystone token-get | awk 'NR==5{print $4}' 获取 Token 第5行第4列 nova endpoints | grep -A 7 glance 获取 Endpoint 9292 curl -H \"X-Auth-Token:$a\" http://0.0.0.0:9292/v1/images 返回镜像列表 curl -H \"X-Auth-Token:$a\" http://0.0.0.0:9292/v1/images/detail 返回镜像列表(详细) curl -H \"X-Auth-Token:$a\" http://0.0.0.0:9292/v1/images/detail?name=centos 返回某个镜像的详细信息 curl -H \"X-Auth-Token:$a\" http://0.0.0.0:9292/v2/images 返回镜像列表(详细) curl -H \"X-Auth-Token:$a\" http://0.0.0.0:9292/v2/images/123 返回某个镜像的详细信息 curl -I -X HEAD -H \"X-Auth-Token:$a\" http://0.0.0.0:9292/v1/images/123 返回某个镜像的 Metadata curl -X GET -H \"X-Auth-Token:$a\" http://0.0.0.0:9292/v1/images/123 \u003e test.img 下载某个镜像 ------------------------------------------------------- glance image-create --name centos6.5 --disk-format qcow2 --container-format bare --is-public True --progress \u003c centos_65_x86_6420140327.qcow2 上传镜像 glance image-update centos6.5 --property hw_disk_bus=scsi --property hw_scsi_model=virtio-scsi 更新镜像 glance image-update centos6.5 --name centos6.5_scsi 更新镜像 Property： hw_disk_bus=scsi hw_scsi_model=virtio-scsi hw_cdrom_bus=ide ------------------------------------------------------- CirrOS https://download.cirros-cloud.net/ user:cirros password:gocubsgo glance image-create --name cirros --disk-format qcow2 --container-format bare \u003c cirros-0.3.4-x86_64-disk.img NOVA nova secgroup-list 列出安全组 nova secgroup-list-rules default 查看安全组 nova secgroup-add-rule default tcp 1 65535 0.0.0.0/0 添加规则 nova secgroup-add-rule default udp 1 65535 0.0.0.0/0 添加规则 nova secgroup-add-rule default icmp -1 -1 0.0.0.0/0 添加规则 ------------------------------------------------------- nova keypair-list 列出密钥对 nova keypair-add 123 \u003e 123.priv 创建密钥对 nova keypair-add --pub-key /root/.ssh/id_rsa.pub 123 添加密钥对 事先已做 ssh-keygen ------------------------------------------------------- nova flavor-list 列出 VM 类型 nova flavor-create 123 auto 1024 20 1 创建 VM 类型 名称 编号 内存 磁盘 内核 ------------------------------------------------------- nova boot --flavor m1.small --image centos6.5 --nic net-id=17589f7c-0504-4485-8c13-53f1b306eab1 123 创建实例 nova list 列出实例 virsh list --all nova show 123 查看实例 nova suspend 123 暂停实例 nova resume 123 恢复实例 nova start 123 启动实例 nova stop 123 停止实例 nova reboot 123 重启实例 nova delete 123 终止实例 nova rename 123 swift 重命名实例 nova image-create 123 snapshot1 为实例创建快照 nova console-log 123 查看启动日志 nova get-vnc-console 123 novnc 获取 VNC URL，通过游览器访问 nova usage-list 列出平台资源使用情况 nova hypervisor-stats 列出虚拟机监控器统计数据 ------------------------------------------------------- nova volume-list 列出云硬盘 CINDER nova volume-show test 显示云硬盘 CINDER nova volume-create --display-name test 1 创建云硬盘 CINDER nova volume-attach 123 5495c0aa-896d-4a50-b40f-3a0730cd6a64 为实例挂载云硬盘 CINDER nova volume-detach 123 5495c0aa-896d-4a50-b40f-3a0730cd6a64 为实例断开云硬盘 CINDER ------------------------------------------------------- nova floating-ip-pool-list 列出浮动 IP 池(外部网络) GRE网络 nova floating-ip-list 列出获取的浮动 IP GRE网络 nova floating-ip-create ext 获取浮动 IP GRE网络 nova floating-ip-associate 123 192.168.200.105 关联浮动 IP GRE网络 CINDER 3：MySQL+KEYSTONE+CINDER ------------------------------------------------------- SWIFT 3：MySQL+KEYSTONE+SWIFT ------------------------------------------------------- swift-init all restart 重新启动所有 SWIFT 服务 swift -U 1:1 -K 1 -V 2 -A http://0.0.0.0:35357/v2.0 stat 查看特定用户信息 swift --os-username=1 --os-password=1 --os-tenant-name=1 --os-auth-url=http://0.0.0.0:35357/v2.0 stat 查看特定用户信息 Heat heat stack-list 列出栈 heat stack-create -f server.yml -P ImageID=centos6.5 -P NetID=int mystack 创建栈 heat event-list mystack 查看栈的事件日志 heat event-show mystack server1 d9c12983-d4df-42ad-bd01-350c9b8abfd6 查看事件日志的详细信息 Ceilometer ceilometer meter-list 查看所有测量值 ceilometer resource-list 查看所有资源 ceilometer resource-show -r a3f74bc8-8200-4345-9f07-fa4aae11567d 查看资源详情 Sahara ssh cloud-user@192.168.200.104 sudo passwd root #修改 root 密码 su #转到 root 用户 passwd cloud-user #修改 cloud-user 密码 passwd hadoop #修改 hadoop 密码 su hadoop #转到 hadoop 用户 jps #查看 Hadoop 进程，开始 Hadoop 操作 \u003e\u003e\u003e GLANCE 使用未加 SCSI 属性的镜像创建的VM - virtio-blk\n使用已加 SCSI 属性的镜像创建的VM - virtio-scsi（更灵活、更具扩展性）\n","wordCount":"713","inLanguage":"en","datePublished":"2016-05-07T08:15:41+08:00","dateModified":"2016-05-07T08:15:41+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://xhstormr.github.io/blog/posts/openstack-operations/"},"publisher":{"@type":"Organization","name":"XhstormR","logo":{"@type":"ImageObject","url":"https://xhstormr.github.io/blog/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xhstormr.github.io/blog/ accesskey=h title="XhstormR (Alt + H)">XhstormR</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://xhstormr.github.io/blog/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://xhstormr.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://xhstormr.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://xhstormr.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://xhstormr.github.io/blog/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">OpenStack 不完全使用手册</h1><div class=post-meta><span title='2016-05-07 08:15:41 +0800 +0800'>2016-05-07</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/XhstormR/blog/tree/master/content/posts/openstack-operations.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#curl---%e5%91%bd%e4%bb%a4%e8%a1%8c%e6%b5%8f%e8%a7%88%e5%99%a8 aria-label="curl - 命令行浏览器">curl - 命令行浏览器</a></li><li><a href=#keystone aria-label=KEYSTONE>KEYSTONE</a></li><li><a href=#glance aria-label=GLANCE>GLANCE</a></li><li><a href=#nova aria-label=NOVA>NOVA</a></li><li><a href=#cinder aria-label=CINDER>CINDER</a></li><li><a href=#swift aria-label=SWIFT>SWIFT</a></li><li><a href=#heat aria-label=Heat>Heat</a></li><li><a href=#ceilometer aria-label=Ceilometer>Ceilometer</a></li><li><a href=#sahara aria-label=Sahara>Sahara</a></li><li><a href=#glance-1 aria-label=GLANCE>GLANCE</a></li></ul></div></details></div><div class=post-content><p>Updated on 2016-10-06</p><blockquote><p><img loading=lazy src=/blog/uploads/openstack-logo.svg></p></blockquote><h2 id=curl---命令行浏览器>curl - <em>命令行浏览器</em><a hidden class=anchor aria-hidden=true href=#curl---命令行浏览器>#</a></h2><p><em>OpenStack 服务提供 RESTful API，而 curl 能通过命令行直接发送和接收 HTTP 的请求和响应</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>-X <span style=color:#f92672>[</span>HEAD,POST,GET,PUT,DELETE<span style=color:#f92672>]</span> <span style=color:#75715e># 指定 HTTP 的请求类型     Request</span>
</span></span><span style=display:flex><span>-H <span style=color:#e6db74>&#34;name:123&#34;</span> <span style=color:#75715e>#添加 HTTP 请求头     Header</span>
</span></span><span style=display:flex><span>-D <span style=color:#f92672>[</span>123,-<span style=color:#f92672>]</span> <span style=color:#75715e>#将 HTTP 响应头输出到[文件,终端]     Dump</span>
</span></span><span style=display:flex><span>-i <span style=color:#75715e>#同时显示 HTTP 响应头     Include</span>
</span></span><span style=display:flex><span>-I <span style=color:#75715e>#只显示文档信息     Head</span>
</span></span><span style=display:flex><span>-u admin:pass <span style=color:#75715e>#登录验证     User</span>
</span></span><span style=display:flex><span>-k <span style=color:#75715e>#忽略主机密钥（SSL 证书）     Insecure</span>
</span></span><span style=display:flex><span>-s <span style=color:#75715e>#不显示进度条     Silent</span>
</span></span><span style=display:flex><span>-v <span style=color:#75715e>#显示详细信息     Verbose</span>
</span></span><span style=display:flex><span>-d @123.json <span style=color:#75715e>#指定 POST 数据包     Data</span>
</span></span><span style=display:flex><span>-F file<span style=color:#f92672>=</span>@123.png <span style=color:#75715e>#指定表单数据     Form</span>
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span><span style=display:flex><span>-A <span style=color:#e6db74>&#34;Mozilla/5.0 (Linux; Android 5.1.1; Nexus 6 Build/LYZ28E) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.20 Mobile Safari/537.36&#34;</span> <span style=color:#75715e>#指定 User-Agent</span>
</span></span><span style=display:flex><span>-e <span style=color:#e6db74>&#34;www.qq.com&#34;</span> <span style=color:#75715e>#指定 Referrer URL</span>
</span></span><span style=display:flex><span>-x 10.34.3.71:808 <span style=color:#75715e>#指定代理服务器</span>
</span></span><span style=display:flex><span>-o <span style=color:#e6db74>&#34;123.7z&#34;</span> <span style=color:#75715e>#保存至本地</span>
</span></span><span style=display:flex><span>-O <span style=color:#75715e>#使用服务器上的文件名</span>
</span></span><span style=display:flex><span>-R <span style=color:#75715e>#使用服务器上的文件修改时间</span>
</span></span><span style=display:flex><span>-b <span style=color:#e6db74>&#34;NAME1=VALUE1; NAME2=VALUE2&#34;</span> <span style=color:#75715e>#设置 Cookie</span>
</span></span><span style=display:flex><span>-b 123.txt <span style=color:#75715e>#读取 Cookie</span>
</span></span><span style=display:flex><span>-c 123.txt <span style=color:#75715e>#保存 Cookie</span>
</span></span><span style=display:flex><span>-C - <span style=color:#75715e>#断点续传     Continue</span>
</span></span><span style=display:flex><span>-L <span style=color:#75715e>#自动重定向     Location</span>
</span></span><span style=display:flex><span>--limit-rate 200K <span style=color:#75715e>#限速</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>https://curl.haxx.se/windows/
</span></span><span style=display:flex><span>https://curl.haxx.se/docs/manpage.html
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>curl -s -H <span style=color:#e6db74>&#34;X-Auth-Token:123&#34;</span> http://0.0.0.0:35357/v2.0/tenants | python -mjson.tool <span style=color:#75715e>#格式化输出 JSON</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@controller ~<span style=color:#f92672>]</span>$ a<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>keystone token-get | awk <span style=color:#e6db74>&#39;NR==5{print $4}&#39;</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@controller ~<span style=color:#f92672>]</span>$ echo $a
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@controller ~<span style=color:#f92672>]</span>$ curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:35357/v2.0/tenants
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@controller ~<span style=color:#f92672>]</span>$ keystone --debug tenant-list     v2.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@controller ~<span style=color:#f92672>]</span>$ glance --debug image-list     v1
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@controller ~<span style=color:#f92672>]</span>$ nova --debug list     v2
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span><span style=display:flex><span>keystone catalog
</span></span><span style=display:flex><span>nova endpoints
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span><span style=display:flex><span>openstack-status
</span></span><span style=display:flex><span>openstack-service restart
</span></span></code></pre></div><h2 id=keystone>KEYSTONE<a hidden class=anchor aria-hidden=true href=#keystone>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>keystone token-get | awk <span style=color:#e6db74>&#39;NR==5{print $4}&#39;</span>     获取 Token     第5行第4列
</span></span><span style=display:flex><span>nova endpoints | grep -A <span style=color:#ae81ff>7</span> keystone     获取 Endpoint     <span style=color:#ae81ff>35357</span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:35357/v2.0/users     返回用户
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:35357/v2.0/users/123     返回某个用户
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:35357/v2.0/tenants     返回租户
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:35357/v2.0/tenants/123     返回某个租户
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:35357/v2.0/tenants/123/users/123/roles     返回某个租户上用户被授予的角色
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:35357/v2.0/endpoints     返回服务端点
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:35357/v2.0/tokens/$a     检验 Token 有效性，并返回 Token 信息
</span></span><span style=display:flex><span>curl -I -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:35357/v2.0/tokens/$a     使用 Header 校验 Token 有效性
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span><span style=display:flex><span>keystone user-role-list --user <span style=color:#ae81ff>123</span> --tenant admin     查看用户在某个租户中的角色
</span></span><span style=display:flex><span>keystone --os-token <span style=color:#ae81ff>123</span> --os-endpoint http://0.0.0.0:35357/v2.0 user-role-add --user admin --role admin --tenant admin     使用 Token 鉴权     keystone.conf - admin_token <span style=color:#f92672>=</span> <span style=color:#ae81ff>123</span>
</span></span><span style=display:flex><span>     Token 验证
</span></span><span style=display:flex><span>     export OS_SERVICE_TOKEN<span style=color:#f92672>=</span>cacb79002f
</span></span><span style=display:flex><span>     export OS_SERVICE_ENDPOINT<span style=color:#f92672>=</span>http://0.0.0.0:35357/v2.0
</span></span><span style=display:flex><span>     -----------
</span></span><span style=display:flex><span>     Password 验证
</span></span><span style=display:flex><span>     export OS_USERNAME<span style=color:#f92672>=</span>admin
</span></span><span style=display:flex><span>     export OS_PASSWORD<span style=color:#f92672>=</span><span style=color:#ae81ff>000000</span>
</span></span><span style=display:flex><span>     export OS_TENANT_NAME<span style=color:#f92672>=</span>admin
</span></span><span style=display:flex><span>     export OS_AUTH_URL<span style=color:#f92672>=</span>http://0.0.0.0:35357/v2.0
</span></span></code></pre></div><h2 id=glance>GLANCE<a hidden class=anchor aria-hidden=true href=#glance>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>keystone token-get | awk <span style=color:#e6db74>&#39;NR==5{print $4}&#39;</span>     获取 Token     第5行第4列
</span></span><span style=display:flex><span>nova endpoints | grep -A <span style=color:#ae81ff>7</span> glance     获取 Endpoint     <span style=color:#ae81ff>9292</span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:9292/v1/images     返回镜像列表
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:9292/v1/images/detail     返回镜像列表<span style=color:#f92672>(</span>详细<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:9292/v1/images/detail?name<span style=color:#f92672>=</span>centos     返回某个镜像的详细信息
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:9292/v2/images     返回镜像列表<span style=color:#f92672>(</span>详细<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>curl -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:9292/v2/images/123     返回某个镜像的详细信息
</span></span><span style=display:flex><span>curl -I -X HEAD -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:9292/v1/images/123     返回某个镜像的 Metadata
</span></span><span style=display:flex><span>curl -X GET -H <span style=color:#e6db74>&#34;X-Auth-Token:</span>$a<span style=color:#e6db74>&#34;</span> http://0.0.0.0:9292/v1/images/123 &gt; test.img     下载某个镜像
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span><span style=display:flex><span>glance image-create --name centos6.5 --disk-format qcow2 --container-format bare --is-public True --progress &lt; centos_65_x86_6420140327.qcow2     上传镜像
</span></span><span style=display:flex><span>glance image-update centos6.5 --property hw_disk_bus<span style=color:#f92672>=</span>scsi --property hw_scsi_model<span style=color:#f92672>=</span>virtio-scsi     更新镜像
</span></span><span style=display:flex><span>glance image-update centos6.5 --name centos6.5_scsi     更新镜像
</span></span><span style=display:flex><span>     Property：
</span></span><span style=display:flex><span>     hw_disk_bus<span style=color:#f92672>=</span>scsi
</span></span><span style=display:flex><span>     hw_scsi_model<span style=color:#f92672>=</span>virtio-scsi
</span></span><span style=display:flex><span>     hw_cdrom_bus<span style=color:#f92672>=</span>ide
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span><span style=display:flex><span>CirrOS
</span></span><span style=display:flex><span>https://download.cirros-cloud.net/
</span></span><span style=display:flex><span>user:cirros     password:gocubsgo
</span></span><span style=display:flex><span>glance image-create --name cirros --disk-format qcow2 --container-format bare &lt; cirros-0.3.4-x86_64-disk.img
</span></span></code></pre></div><h2 id=nova>NOVA<a hidden class=anchor aria-hidden=true href=#nova>#</a></h2><pre tabindex=0><code>nova secgroup-list     列出安全组
nova secgroup-list-rules default     查看安全组
nova secgroup-add-rule default tcp 1 65535 0.0.0.0/0     添加规则
nova secgroup-add-rule default udp 1 65535 0.0.0.0/0     添加规则
nova secgroup-add-rule default icmp -1 -1 0.0.0.0/0     添加规则
-------------------------------------------------------
nova keypair-list     列出密钥对
nova keypair-add 123 &gt; 123.priv     创建密钥对
nova keypair-add --pub-key /root/.ssh/id_rsa.pub 123     添加密钥对     事先已做 ssh-keygen
-------------------------------------------------------
nova flavor-list     列出 VM 类型
nova flavor-create 123 auto 1024 20 1     创建 VM 类型     名称 编号 内存 磁盘 内核
-------------------------------------------------------
nova boot --flavor m1.small --image centos6.5 --nic net-id=17589f7c-0504-4485-8c13-53f1b306eab1 123     创建实例
nova list     列出实例     virsh list --all
nova show 123     查看实例
nova suspend 123     暂停实例
nova resume 123     恢复实例
nova start 123     启动实例
nova stop 123     停止实例
nova reboot 123     重启实例
nova delete 123     终止实例
nova rename 123 swift     重命名实例
nova image-create 123 snapshot1     为实例创建快照
nova console-log 123     查看启动日志
nova get-vnc-console 123 novnc     获取 VNC URL，通过游览器访问
nova usage-list     列出平台资源使用情况
nova hypervisor-stats     列出虚拟机监控器统计数据
-------------------------------------------------------
nova volume-list     列出云硬盘     CINDER
nova volume-show test     显示云硬盘     CINDER
nova volume-create --display-name test 1     创建云硬盘     CINDER
nova volume-attach 123 5495c0aa-896d-4a50-b40f-3a0730cd6a64     为实例挂载云硬盘     CINDER
nova volume-detach 123 5495c0aa-896d-4a50-b40f-3a0730cd6a64     为实例断开云硬盘     CINDER
-------------------------------------------------------
nova floating-ip-pool-list     列出浮动 IP 池(外部网络)     GRE网络
nova floating-ip-list     列出获取的浮动 IP     GRE网络
nova floating-ip-create ext     获取浮动 IP     GRE网络
nova floating-ip-associate 123 192.168.200.105     关联浮动 IP     GRE网络
</code></pre><h2 id=cinder>CINDER<a hidden class=anchor aria-hidden=true href=#cinder>#</a></h2><pre tabindex=0><code>3：MySQL+KEYSTONE+CINDER
-------------------------------------------------------
</code></pre><h2 id=swift>SWIFT<a hidden class=anchor aria-hidden=true href=#swift>#</a></h2><pre tabindex=0><code>3：MySQL+KEYSTONE+SWIFT
-------------------------------------------------------
swift-init all restart     重新启动所有 SWIFT 服务
swift -U 1:1 -K 1 -V 2 -A http://0.0.0.0:35357/v2.0 stat     查看特定用户信息
swift --os-username=1 --os-password=1 --os-tenant-name=1 --os-auth-url=http://0.0.0.0:35357/v2.0 stat     查看特定用户信息
</code></pre><h2 id=heat>Heat<a hidden class=anchor aria-hidden=true href=#heat>#</a></h2><pre tabindex=0><code>heat stack-list     列出栈
heat stack-create -f server.yml  -P ImageID=centos6.5 -P NetID=int mystack     创建栈
heat event-list mystack     查看栈的事件日志
heat event-show mystack server1 d9c12983-d4df-42ad-bd01-350c9b8abfd6     查看事件日志的详细信息
</code></pre><h2 id=ceilometer>Ceilometer<a hidden class=anchor aria-hidden=true href=#ceilometer>#</a></h2><pre tabindex=0><code>ceilometer meter-list     查看所有测量值
ceilometer resource-list     查看所有资源
ceilometer resource-show -r  a3f74bc8-8200-4345-9f07-fa4aae11567d     查看资源详情
</code></pre><h2 id=sahara>Sahara<a hidden class=anchor aria-hidden=true href=#sahara>#</a></h2><pre tabindex=0><code>ssh cloud-user@192.168.200.104
sudo passwd root #修改 root 密码
su #转到 root 用户
passwd cloud-user #修改 cloud-user 密码
passwd hadoop #修改 hadoop 密码
su hadoop #转到 hadoop 用户
jps #查看 Hadoop 进程，开始 Hadoop 操作 &gt;&gt;&gt;
</code></pre><hr><h2 id=glance-1>GLANCE<a hidden class=anchor aria-hidden=true href=#glance-1>#</a></h2><p>使用未加 SCSI 属性的镜像创建的VM - virtio-blk</p><p><img loading=lazy src=/blog/uploads/openstack-glance-normal.png title=virtio-blk></p><p>使用已加 SCSI 属性的镜像创建的VM - virtio-scsi（更灵活、更具扩展性）</p><p><img loading=lazy src=/blog/uploads/openstack-glance-scsi.png title=virtio-scsi></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://xhstormr.github.io/blog/tags/openstack/>OpenStack</a></li></ul><nav class=paginav><a class=prev href=https://xhstormr.github.io/blog/posts/http-status-code/><span class=title>« Prev</span><br><span>HTTP Status Code</span>
</a><a class=next href=https://xhstormr.github.io/blog/posts/openstack/><span class=title>Next »</span><br><span>自学 OpenStack</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share OpenStack 不完全使用手册 on x" href="https://x.com/intent/tweet/?text=OpenStack%20%e4%b8%8d%e5%ae%8c%e5%85%a8%e4%bd%bf%e7%94%a8%e6%89%8b%e5%86%8c&amp;url=https%3a%2f%2fxhstormr.github.io%2fblog%2fposts%2fopenstack-operations%2f&amp;hashtags=OpenStack"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share OpenStack 不完全使用手册 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fxhstormr.github.io%2fblog%2fposts%2fopenstack-operations%2f&amp;title=OpenStack%20%e4%b8%8d%e5%ae%8c%e5%85%a8%e4%bd%bf%e7%94%a8%e6%89%8b%e5%86%8c&amp;summary=OpenStack%20%e4%b8%8d%e5%ae%8c%e5%85%a8%e4%bd%bf%e7%94%a8%e6%89%8b%e5%86%8c&amp;source=https%3a%2f%2fxhstormr.github.io%2fblog%2fposts%2fopenstack-operations%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share OpenStack 不完全使用手册 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fxhstormr.github.io%2fblog%2fposts%2fopenstack-operations%2f&title=OpenStack%20%e4%b8%8d%e5%ae%8c%e5%85%a8%e4%bd%bf%e7%94%a8%e6%89%8b%e5%86%8c"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share OpenStack 不完全使用手册 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fxhstormr.github.io%2fblog%2fposts%2fopenstack-operations%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share OpenStack 不完全使用手册 on whatsapp" href="https://api.whatsapp.com/send?text=OpenStack%20%e4%b8%8d%e5%ae%8c%e5%85%a8%e4%bd%bf%e7%94%a8%e6%89%8b%e5%86%8c%20-%20https%3a%2f%2fxhstormr.github.io%2fblog%2fposts%2fopenstack-operations%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share OpenStack 不完全使用手册 on telegram" href="https://telegram.me/share/url?text=OpenStack%20%e4%b8%8d%e5%ae%8c%e5%85%a8%e4%bd%bf%e7%94%a8%e6%89%8b%e5%86%8c&amp;url=https%3a%2f%2fxhstormr.github.io%2fblog%2fposts%2fopenstack-operations%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share OpenStack 不完全使用手册 on ycombinator" href="https://news.ycombinator.com/submitlink?t=OpenStack%20%e4%b8%8d%e5%ae%8c%e5%85%a8%e4%bd%bf%e7%94%a8%e6%89%8b%e5%86%8c&u=https%3a%2f%2fxhstormr.github.io%2fblog%2fposts%2fopenstack-operations%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://xhstormr.github.io/blog/>XhstormR</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>